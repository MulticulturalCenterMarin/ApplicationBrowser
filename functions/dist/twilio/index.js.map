{"version":3,"sources":["../../src/twilio/index.js"],"names":["_","require","admin","functions","twilio","db","accountSid","config","accountsid","authToken","authtoken","twilioClient","twilioTextSend","console","log","message","messages","create","to","textRecipient","body","textBody","from","then","uid","key","twilioMessage","sid","databaseWrite","entity","branches","payload","writeType","error","twilioTextBatchSend","map","twilioVoiceSend"],"mappings":"oEACA,GAAMA,GAAIC,QAAQ,QAAR,CAAV,CACMC,MAAQD,QAAQ,gBAAR,CADd,CAEME,UAAYF,QAAQ,oBAAR,CAFlB,CAGMG,OAASH,QAAQ,QAAR,CAHf,CAKMI,GAAKJ,QAAQ,aAAR,CALX,CAOMK,WAAaH,UAAUI,MAAV,GAAmBH,MAAnB,CAA0BI,UAP7C,CAQMC,UAAYN,UAAUI,MAAV,GAAmBH,MAAnB,CAA0BM,SAR5C,CAUMC,aAAe,GAAIP,OAAJ,CAAWE,UAAX,CAAuBG,SAAvB,CAVrB,CAmBaG,sCAAiB,aAAkB,CAC9C,GAAI,CACFC,QAAQC,GAAR,CAAYC,CAAZ,CADE,CAEFJ,aAAaK,QAAb,CAAsBC,MAAtB,CAA6B,CAC3BC,GAAIH,EAAQI,aADe,CAE3BC,KAAML,EAAQM,QAFa,CAG3BC,KAAM,cAHqB,CAA7B,EAKCC,IALD,CAKO,WAAW,CAChB,GAAM,GAAU,CACdC,IAAKC,CADS,CAEdC,cAAeX,EAAQY,GAFT,CAAhB,CAIAtB,GAAGuB,aAAH,CAAiB,CACfC,OAAQ,gBADO,CAEfC,6CAFe,CAGfC,QAASA,CAHM,CAIfxB,OAAQ,CACNyB,UAAW,MADL,CAJO,CAAjB,CAQD,CAlBD,CAmBD,CAAC,QAAc,CACdnB,QAAQC,GAAR,CAAYmB,CAAZ,CACD,CACF,CA5CD,CAmDaC,gDAAsB,WAAc,CAC/ClC,EAAEmC,GAAF,CAAMnB,CAAN,CAAgB,WAAS,CACvBL,aAAaK,QAAb,CAAsBC,MAAtB,CAA6B,CAC3BC,GAAIH,EAAQI,aADe,CAE3BC,KAAML,EAAQM,QAFa,CAG3BC,KAAM,cAHqB,CAA7B,EAKCC,IALD,CAKM,kBAAaV,SAAQC,GAAR,CAAYC,EAAQY,GAApB,CAAb,CALN,CAMD,CAPD,CAQD,CA5DD,CA8DaS,wCAAkB,UAAI,CAAE,CA9DrC","file":"index.js","sourcesContent":["/* ------------------------- External Dependencies -------------------------- */\nconst _ = require('lodash')\nconst admin = require('firebase-admin');\nconst functions = require('firebase-functions');\nconst twilio = require('twilio');\n/* ------------------------- Internal Dependencies -------------------------- */\nconst db = require('../database');\n/* ---------------------------- Initialization ------------------------------ */\nconst accountSid = functions.config().twilio.accountsid\nconst authToken = functions.config().twilio.authtoken\n\nconst twilioClient = new twilio(accountSid, authToken);\n/* ---------------------------- Cloud Functions ------------------------------ */\n/**\n * @func twilioTextSend\n * @desc Send text messages via Twilio \n * @param {Object} message\n * @var textRecipient\n * @var textBody\n */\nexport const twilioTextSend = (key, message) => {\n  try {\n    console.log(message)\n    twilioClient.messages.create({\n      to: message.textRecipient,\n      body: message.textBody,\n      from: '+14152756694' // Valid Twilio number\n    })\n    .then( message => {\n      const payload = {\n        uid: key,\n        twilioMessage: message.sid\n      }\n      db.databaseWrite({\n        entity: 'infrastructure',\n        branches: ['messages', 'outbound', 'monitoring'],\n        payload: payload,\n        config: {\n          writeType: 'push'\n        }\n      });\n    });\n  } catch (error) {\n    console.log(error)\n  }\n}\n\n/**\n * @func twilioTextBatchSend\n * @desc Send text messages via Twilio \n * @param {Array} messages\n */\nexport const twilioTextBatchSend = (messages) => {\n  _.map(messages, message=>{\n    twilioClient.messages.create({\n      to: message.textRecipient,\n      body: message.textBody,\n      from: '+14159914545' // Valid Twilio number\n    })\n    .then((message) => console.log(message.sid));\n  })\n}\n\nexport const twilioVoiceSend = ()=>{}"]}